{% extends 'base.html' %}

{% block styles %}
{{ super() }}
<!-- Include Select2 CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0/css/select2.min.css" rel="stylesheet" />
<style>
    .select2-container--bootstrap4 .select2-selection--single {
        height: calc(1.5em + 0.75rem + 2px);
        padding: 0.375rem 1.75rem 0.375rem 0.75rem;
        font-size: 1rem;
        font-weight: normal;
        line-height: 1.5;
        color: #495057;
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: 0.25rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">Add Product</h1>
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <div class="card shadow-sm">
                <div class="card-body">
                    <form method="POST" action="{{ url_for('main.add_product') }}" novalidate>
                        {{ form.hidden_tag() }}
                        
                        <!-- ProcategBrand -->
                        <div class="mb-3">
                            {{ form.name.label(class='form-label') }}
                            {{ form.name(class='form-control', placeholder='Enter product Brand', required=true) }}
                            {% if form.name.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.name.errors[0] }}
                            </div>
                            {% endif %}
                        </div>
                        
                        <!-- Category -->
                        <div class="mb-3">
                            {{ form.category.label(class='form-label') }}
                            {{ form.category(class='form-select', required=true, id='category') }}
                            {% if form.category.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.category.errors[0] }}
                            </div>
                            {% endif %}
                        </div>
                        
                        <!-- Product name -->
                        <div class="mb-3">
                            {{ form.brand.label(class='form-label') }}
                            {{ form.brand(class='form-control', placeholder='Enter Product Name', required = true) }}
                            {% if form.brand.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.brand.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Unit Price -->
                        <div class="mb-3">
                            {{ form.unit_price.label(class='form-label') }}
                            {{ form.unit_price(class='form-control', placeholder='Enter Unit Price', required=true) }}
                            {% if form.unit_price.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.unit_price.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Unit Measurement -->
                        <div class="mb-3">
                            {{ form.unit_measurement.label(class='form-label') }}
                            {{ form.unit_measurement(class='form-control', placeholder='Enter Unit of Measurement') }}
                            {% if form.unit_measurement.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.unit_measurement.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Quantity in Stock -->
                        <div class="mb-3">
                            {{ form.quantity_in_stock.label(class='form-label') }}
                            {{ form.quantity_in_stock(class='form-control', placeholder='Enter Quantity in Stock', required=true) }}
                            {% if form.quantity_in_stock.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.quantity_in_stock.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Discount Percentage -->
                        <div class="mb-3">
                            {{ form.discount_percentage.label(class='form-label') }}
                            {{ form.discount_percentage(class='form-control', placeholder='Enter Discount Percentage') }}
                            {% if form.discount_percentage.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.discount_percentage.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Promotional Tag -->
                        <div class="mb-3">
                            {{ form.promotional_tag.label(class='form-label') }}
                            {{ form.promotional_tag(class='form-control', placeholder='Enter Promotional Tag') }}
                            {% if form.promotional_tag.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.promotional_tag.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Nutritional Information -->
                        <div class="mb-3">
                            {{ form.nutritional_information.label(class='form-label') }}
                            {{ form.nutritional_information(class='form-control', placeholder='Enter Nutritional Information') }}
                            {% if form.nutritional_information.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.nutritional_information.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Country of Origin -->
                        <div class="mb-3">
                            {{ form.country_of_origin.label(class='form-label') }}
                            {{ form.country_of_origin(class='form-control', placeholder='Enter Country of Origin') }}
                            {% if form.country_of_origin.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.country_of_origin.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Supplier -->
                        <div class="mb-3">
                            {{ form.supplier.label(class='form-label') }}
                            {{ form.supplier(class='form-select', required=true, id='supplier') }}
                            {% if form.supplier.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.supplier.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Date Added -->
                        <div class="mb-3">
                            {{ form.date_added.label(class='form-label') }}
                            {{ form.date_added(class='form-control datepicker', placeholder='Select Date Added', required=true) }}
                            {% if form.date_added.errors %}
                            <div class="invalid-feedback d-block">
                                {{ form.date_added.errors[0] }}
                            </div>
                            {% endif %}
                        </div>

                        <!-- Submit Button with Loader -->
                        <button type="submit" class="btn btn-primary position-relative" id="submitBtn">
                            <span class="me-2">Add Product</span>
                            <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Include jQuery and Select2 JavaScript -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0/js/select2.min.js"></script>

<!-- Date Picker Initialization -->
<script type="text/javascript">
    $(document).ready(function(){
        $('.datepicker').datepicker({
            format: 'yyyy-mm-dd',
            autoclose: true,
            todayHighlight: true
        });
    });

    // Initialize Select2 for select fields
    $(document).ready(function() {
        $('#category').select2({
            placeholder: 'Select a Category',
            allowClear: true,
            theme: 'bootstrap4'
        });

        $('#supplier').select2({
            placeholder: 'Select a Supplier',
            allowClear: true,
            theme: 'bootstrap4'
        });

        // Disable first options in select fields
        $('#category option:first-child').attr('disabled', 'disabled');
        $('#supplier option:first-child').attr('disabled', 'disabled');
    });

    // Handle form submission with loader
    $(document).ready(function() {
        $('form').submit(function() {
            $('#submitBtn .spinner-border').removeClass('d-none');
            $('#submitBtn').attr('disabled', 'disabled');
        });
    });
</script>
{% endblock %}
