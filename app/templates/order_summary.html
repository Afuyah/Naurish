{% extends 'layout.html' %}

{% block content %}
<style>
    /* Themed Colors */
    :root {
        --primary-color: #673AB7; /* Deep purple */
        --secondary-color: #FFC107; /* Amber */
        --tertiary-color: #2196F3; /* Blue */
    }

    /* Page Styles */
    .summary-container {
        margin-top: 3rem;
    }

    .summary-header {
        text-align: center;
        margin-bottom: 2rem;
        font-size: 2.5rem;
        color: var(--primary-color);
    }

    .summary-table th,
    .summary-table td {
        text-align: center;
        vertical-align: middle;
    }

    .summary-table {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        overflow: hidden;
    }

    .summary-table th {
        background-color: #f0f0f0;
    }

    .shipping-info,
    .payment-info {
        margin-bottom: 2rem;
        padding: 1.5rem;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #fff;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .summary-footer {
        text-align: center;
        margin-top: 2rem;
    }

    .edit-details-btn,
    .confirm-order-btn {
        display: inline-block;
        padding: 1rem 2.5rem;
        font-size: 1.2rem;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .edit-details-btn {
        background-color: var(--secondary-color);
        color: #fff;
        border: none;
    }

    .edit-details-btn:hover {
        background-color: #FFA000; /* Darker Amber */
    }

    .confirm-order-btn {
        background-color: var(--tertiary-color);
        color: #fff;
        border: none;
    }

    .confirm-order-btn:hover {
        background-color: #1976D2; /* Darker Blue */
    }

    .alert-link {
        color: var(--secondary-color); /* Amber */
        text-decoration: underline;
    }

    /* Responsive Styles */
    @media (max-width: 768px) {
        .summary-container {
            margin-top: 2rem;
        }

        .summary-header {
            font-size: 2rem;
        }

        .edit-details-btn,
        .confirm-order-btn {
            display: block;
            width: 100%;
            margin-bottom: 1rem;
        }
    }
</style>

<div class="container summary-container">
    <div class="row">
        <div class="col-md-12">
            <h2 class="summary-header">Order Summary</h2>
        </div>
    </div>

    <div class="row">
        <div class="col-md-10 offset-md-1">
            <div class="card">
                <div class="card-body">
                    {% if cart_items %}
                    <div class="table-responsive">
                        <table class="table summary-table">
                            <thead class="thead-light">
                                <tr>
                                    <th>Product</th>
                                    <th>Quantity</th>
                                    <th>Price</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in cart_items %}
                                <tr>
                                    <td>{{ item.product.brand }}</td>
                                    <td>{{ item.quantity }}</td>
                                    <td>Ksh. {{ item.product.unit_price * item.quantity }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    <div class="mb-4">
                        <p class="text-muted text-center">Standard shipping fee: Ksh 200.</p>
                        <h3 class="text-center">Total Amount + Shipping: Ksh. {{ total_price }}</h3>
                    </div>

                    <div class="shipping-info mb-4">
                        <h4>Shipping Information</h4>
                        <p><strong>Name:</strong> {{ delivery_info.full_name }}</p>
                        <p><strong>Phone:</strong> {{ delivery_info.phone_number }}</p>
                        {% if delivery_info.alt_phone_number %}
                        <p><strong>Alternative Phone:</strong> {{ delivery_info.alt_phone_number }}</p>
                        {% endif %}
                        <p><strong>Location:</strong> {{ location.name }}</p>
                        <p><strong>Arealine:</strong> {{ arealine.name }}</p>
                        <p><strong>Nearest Place:</strong> {{ nearest_place.name }}</p>
                        <p><strong>Address:</strong> {{ delivery_info.address_line }}</p>
                    </div>

                    <div class="payment-info mb-4">
                        <h4>Payment Method</h4>
                        <p><strong>Method:</strong> {{ delivery_info.payment_method }}</p>
                    </div>

                    <form method="post">
                        {{ form.csrf_token }}
                        <div class="summary-footer">
                            <a href="{{ url_for('cart.checkout') }}" class="btn edit-details-btn">Edit Details</a>
                            <button type="submit" class="btn confirm-order-btn">Confirm and Place Order</button>
                        </div>
                    </form>
                    {% else %}
                    <div class="alert alert-info text-center" role="alert">
                        Your grocery cart is empty.
                        <a href="{{ url_for('main.product_listing') }}" class="alert-link">EXPLORE OUR STORE</a>
                        and add items before checking out.
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
